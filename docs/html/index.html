<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pgbitmap: pgbitmap - Bitmap Extension for Postgres</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pgbitmap
   </div>
   <div id="projectbrief">Postgres extension providing a bitmap type</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pgbitmap - <a class="el" href="structBitmap.html">Bitmap</a> Extension for Postgres </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This extension creates a space-optimised, non-sparse, bitmap type for postgres.</p>
<p>A bitmap is an array of bits, indexed by an integer. Bitmaps provide an efficient means to implement sets and <code>pgbitmap</code> provides operations for:</p>
<ul>
<li>creating new bitmaps;</li>
<li>adding an element to a bitmap;</li>
<li>removing an element from a bitmap;</li>
<li>testing for inclusion of an element in a bitmap;</li>
<li>finding the minimum and maximum bits in the bitmap;</li>
<li>unioning bitmaps together (set union/logical or);</li>
<li>intersecting bitmaps (set intersection/logical and);</li>
<li>subtracting one bitmap from another;</li>
<li>converting bitmaps to and from textual representations;</li>
<li>converting bitmaps to and from arrays;</li>
<li>aggregating bits, and bitmaps, into bitmaps.</li>
</ul>
<h1>Status </h1>
<p>This is a beta release. The plan is to give it real-life usage before releasing a production version if all looks well.</p>
<p>There are no known bugs or deficiencies. If you find any problems or want enhancements, contact me and I will do what I can to respond quickly.</p>
<h1>Change History </h1>
<p>0.2 (alpha) Initial release</p>
<p>0.3 (alpha) Fix for bitmap corruption when adding bit to empty bitmap.</p>
<p>0.5 (alpha) Change name of extension to pgbitmap from bitmap.</p>
<p>0.6 (alpha) Minor fixes to Makefiles find_pg_config and docs</p>
<p>0.9 (beta) Minor updates to documentation and to allow distribution through pgxn. Updated to Beta status as it all seems stable enough.</p>
<p>0.9.1 (beta) Updated to convince pgxn to fully index the extension.</p>
<p>0.9.2 (beta) Fix for bitmap union bug on unions of empty bitmaps.</p>
<p>0.9.3 (beta) No-change update for release to PGXN</p>
<h1>Doxygen Docs </h1>
<p><code>pgbitmap</code> is documented internally using Doxygen, with this page acting as the start page. The current docs can be found <a href="https://marcmunro.github.io/pgbitmap/docs/html/index.html">here</a>.</p>
<h1>Why not use the Postgres Bitstring Type? </h1>
<p>The standard Postgres bit type is limited in a number of ways. In particular, each bit string starts at bit zero so a bitstring for bit 1,000,000 would contain the overhead of 1,000,000 zero bits. It also, currently, does not have all of the functionality that this bitmap type provides.</p>
<h1>What is this useful for? </h1>
<p>Pgbitmap was developed as a means of implementing sets of integers. It is particularly suited for managing sets of privileges for Virtual Private Database implementations.</p>
<h1>API Summary </h1>
<p>Functions: </p><div class="fragment"><div class="line"><a class="code" href="pgbitmap_8c.html#ae5e1e9101ae75e4be86486d4d7bde602">bitmap_in</a>(text) -&gt; bitmap</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a6a20dff8a779e2448228017ab59eb704">bitmap_out</a>(bitmap) -&gt; text</div><div class="line"></div><div class="line">bitmap() -&gt; bitmap                          implemented by <a class="code" href="pgbitmap_8c.html#af15551d22dbeb2c30b953604e986ed5b">bitmap_new_empty</a>()</div><div class="line"></div><div class="line">bitmap(integer) -&gt; bitmap                   implemented by <a class="code" href="pgbitmap_8c.html#acef8c24d1caffc90682e6f2c4f0668c6">bitmap_new</a>()</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a794b0ef8eb09645e4d1c0bb0d2e7d2d9">bitmap_setbit</a>(bitmap, integer) -&gt; bitmap</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a08c2640acb10ec32411ae40132419dfb">bitmap_testbit</a>(bitmap, integer) -&gt; <span class="keywordtype">boolean</span></div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a459d7f7ed8bdd2470313fdccb6e3c45f">bitmap_clearbit</a>(bitmap, integer) -&gt; bitmap</div><div class="line"></div><div class="line">is_empty(bitmap) -&gt; <span class="keywordtype">boolean</span>                 implemented by <a class="code" href="pgbitmap_8c.html#a85fbc354d13d28108a6bbf4fa70b4430">bitmap_is_empty</a>()</div><div class="line"></div><div class="line">bitmin(bitmap) -&gt; integer                   implemented by <a class="code" href="pgbitmap_8c.html#a5fa3474087a4208a333887ea161f4cd8">bitmap_bitmin</a>()</div><div class="line"></div><div class="line">bitmax(bitmap) -&gt; integer                   implemented by <a class="code" href="pgbitmap_8c.html#af403584d637574d9252b1f70dddfe59e">bitmap_bitmax</a>()</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a1eed88fa88b6d53eef0942def83bdfd7">bitmap_setmin</a>(bitmap, integer) -&gt; bitmap</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a6611940332cd7d8e76c25ed6e000f2cd">bitmap_setmax</a>(bitmap, integer) -&gt; bitmap</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#abc0a6ac9d53ecd59091e350c290ff378">bitmap_equal</a>(bitmap, bitmap) -&gt; <span class="keywordtype">boolean</span></div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#ab2e7b72cc9e738cad6d0dac31caaa454">bitmap_nequal</a>(bitmap, bitmap) -&gt; <span class="keywordtype">boolean</span></div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#ac7ceb7030568a5289d7e1a7bfee1b59c">bitmap_lt</a>(bitmap, bitmap) -&gt; <span class="keywordtype">boolean</span></div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#ae0fca824298ce73d5e7d9c028b106711">bitmap_le</a>(bitmap, bitmap) -&gt; <span class="keywordtype">boolean</span></div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a77de9774d0447fd9119d16afe9ec7b20">bitmap_gt</a>(bitmap, bitmap) -&gt; <span class="keywordtype">boolean</span></div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a9eae794dcbe1366d16726c41c60037a5">bitmap_ge</a>(bitmap, bitmap) -&gt; <span class="keywordtype">boolean</span></div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a5af367bb00d31f8d9f31b121a70dcc12">bitmap_cmp</a>(bitmap, bitmap) -&gt; integer</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#af1fb14a8c2c70a0927c140df5375874e">bitmap_union</a>(bitmap, bitmap) -&gt; bitmap</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a3083ed0866ef513f208ee8b0b204bcfa">bitmap_intersection</a>(bitmap, bitmap) -&gt; bitmap</div><div class="line"></div><div class="line"><a class="code" href="pgbitmap_8c.html#a5057baf2a406be73117e928e162b537f">bitmap_minus</a>(bitmap, bitmap) -&gt; bitmap</div><div class="line"></div><div class="line">to_array(bitmap) -&gt; array of integer        </div><div class="line"></div><div class="line">to_bitmap(array of integer) -&gt; bitmap       implemented using aggregate bitmap_of()</div></div><!-- fragment --><p>Set Returning Functions: </p><div class="fragment"><div class="line">bits(bitmap) -&gt; <span class="keyword">set</span> of integer              implemented by <a class="code" href="pgbitmap_8c.html#aa1ac399dbbff4c50683c66de24028f92">bitmap_bits</a>()</div></div><!-- fragment --><p>Operators: </p><div class="fragment"><div class="line">bitmap + integer -&gt; bitmap                  implemented by <a class="code" href="pgbitmap_8c.html#a794b0ef8eb09645e4d1c0bb0d2e7d2d9">bitmap_setbit</a>()</div><div class="line"></div><div class="line">bitmap ? integer -&gt; <span class="keywordtype">boolean</span>                 implemented by <a class="code" href="pgbitmap_8c.html#a08c2640acb10ec32411ae40132419dfb">bitmap_testbit</a>()</div><div class="line"></div><div class="line">bitmap - integer -&gt; bitmap                  implemented by <a class="code" href="pgbitmap_8c.html#a459d7f7ed8bdd2470313fdccb6e3c45f">bitmap_clearbit</a>()</div><div class="line"></div><div class="line">bitmap = bitmap -&gt; <span class="keywordtype">boolean</span>                  implemented by <a class="code" href="pgbitmap_8c.html#abc0a6ac9d53ecd59091e350c290ff378">bitmap_equal</a>()</div><div class="line"></div><div class="line">bitmap &lt;&gt; bitmap -&gt; <span class="keywordtype">boolean</span>                 implemented using <a class="code" href="pgbitmap_8c.html#abc0a6ac9d53ecd59091e350c290ff378">bitmap_equal</a>()</div><div class="line"></div><div class="line">bitmap &lt; bitmap -&gt; <span class="keywordtype">boolean</span>                  implemented by <a class="code" href="pgbitmap_8c.html#ac7ceb7030568a5289d7e1a7bfee1b59c">bitmap_lt</a>()</div><div class="line"></div><div class="line">bitmap &lt;= bitmap -&gt; <span class="keywordtype">boolean</span>                 implemented by <a class="code" href="pgbitmap_8c.html#ae0fca824298ce73d5e7d9c028b106711">bitmap_le</a>()</div><div class="line"></div><div class="line">bitmap &gt; bitmap -&gt; <span class="keywordtype">boolean</span>                  implemented by <a class="code" href="pgbitmap_8c.html#a77de9774d0447fd9119d16afe9ec7b20">bitmap_gt</a>()</div><div class="line"></div><div class="line">bitmap &gt;= bitmap -&gt; <span class="keywordtype">boolean</span>                 implemented by <a class="code" href="pgbitmap_8c.html#a9eae794dcbe1366d16726c41c60037a5">bitmap_ge</a>()</div><div class="line"></div><div class="line">bitmap + bitmap -&gt; bitmap                   implemented by <a class="code" href="pgbitmap_8c.html#af1fb14a8c2c70a0927c140df5375874e">bitmap_union</a>()</div><div class="line"></div><div class="line">bitmap * bitmap -&gt; bitmap                   implemented by <a class="code" href="pgbitmap_8c.html#a3083ed0866ef513f208ee8b0b204bcfa">bitmap_intersection</a>()</div><div class="line"></div><div class="line">bitmap - bitmap -&gt; bitmap                   implemented by <a class="code" href="pgbitmap_8c.html#a5057baf2a406be73117e928e162b537f">bitmap_minus</a>()</div></div><!-- fragment --><p>Aggregates: </p><div class="fragment"><div class="line">bitmap_of(integer) -&gt; bitmap                implemented by <a class="code" href="pgbitmap_8c.html#a794b0ef8eb09645e4d1c0bb0d2e7d2d9">bitmap_setbit</a>()</div><div class="line"></div><div class="line">union_of(bitmap) -&gt; bitmap                  implemented by <a class="code" href="pgbitmap_8c.html#af1fb14a8c2c70a0927c140df5375874e">bitmap_union</a>()</div><div class="line"></div><div class="line">intersect_of(bitmap) -&gt; bitmap              implemented by <a class="code" href="pgbitmap_8c.html#a3083ed0866ef513f208ee8b0b204bcfa">bitmap_intersection</a>()</div></div><!-- fragment --><h1>API Details and Examples </h1>
<h2>Conversion to and from text </h2>
<div class="fragment"><div class="line">bitmap_in(text) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap_out(bitmap) -&gt; text</div></div><!-- fragment --><p>The bitmap type has a compact textual representation that is not intended to be human-readable. This textual representation enables bitmaps to be used in hstore, and in text-based backups.</p>
<p>In addition to the functions described above, casts, <code>::text</code>, <code>::bitmap</code>, can also be used.</p>
<h2>Creating bitmaps </h2>
<div class="fragment"><div class="line">bitmap() -&gt; bitmap</div><div class="line"></div><div class="line">bitmap(integer) -&gt; bitmap</div><div class="line"></div><div class="line">to_bitmap(array of integer) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap_of(aggregate of integer) -&gt; bitmap</div></div><!-- fragment --><p>An empty bitmap can be created using <code>bitmap()</code>. A bitmap with a single element included (ie a single bit set to 1) can also be created using <code>bitmap(n)</code>. Bitmaps are more usually created from arrays or queries. The following queries return identical bitmaps:</p>
<div class="fragment"><div class="line">select bitmap() + 1 + 2 + 3;</div><div class="line"></div><div class="line">select bitmap(1) + 2 + 3;</div><div class="line"></div><div class="line">select bitmap_setbit(bitmap_setbit(bitmap(1), 2), 3);</div><div class="line"></div><div class="line">select to_bitmap(&#39;{1, 2, 3}&#39;);</div><div class="line"></div><div class="line">select array[1, 2, 3]::bitmap;</div><div class="line"></div><div class="line">select bitmap_of(x)</div><div class="line">  from generate_series(1, 3) x;</div></div><!-- fragment --><h2>Bit Manipulation and Testing </h2>
<div class="fragment"><div class="line">bitmap_setbit(bitmap, integer) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap + integer -&gt; bitmap</div><div class="line"></div><div class="line">bitmap_clearbit(bitmap, integer) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap - integer -&gt; bitmap</div><div class="line"></div><div class="line">bitmap_testbit(bitmap, integer) -&gt; boolean</div><div class="line"></div><div class="line">bitmap ? integer -&gt; boolean</div></div><!-- fragment --><p> Elements can be added to a bitmap using the <code><a class="el" href="pgbitmap_8c.html#a794b0ef8eb09645e4d1c0bb0d2e7d2d9">bitmap_setbit()</a></code> function or the <code>+</code> operator. They can be removed using <code><a class="el" href="pgbitmap_8c.html#a459d7f7ed8bdd2470313fdccb6e3c45f">bitmap_clearbit()</a></code> or the <code>-</code> operator, and can be tested using the <code><a class="el" href="pgbitmap_8c.html#a08c2640acb10ec32411ae40132419dfb">bitmap_testbit()</a></code> function or the <code>?</code> operator. The setbit and clearbit functions are rarely directly used in SQL, as array or aggregation operations are usually faster.</p>
<p>This is how you might test for a privilege, in a round-about sort of way: </p><div class="fragment"><div class="line">select bitmap_of(privilege_id) ? 42</div><div class="line">  from my_privileges;</div></div><!-- fragment --> <h2><a class="el" href="structBitmap.html">Bitmap</a> Range Functions </h2>
<div class="fragment"><div class="line">is_empty(bitmap) -&gt; boolean</div><div class="line"></div><div class="line">bitmin(bitmap) -&gt; integer</div><div class="line"></div><div class="line">bitmin(bitmap) -&gt; integer</div><div class="line"></div><div class="line">bitmap_setmin(bitmap, integer) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap_setmax(bitmap, integer) -&gt; bitmap</div></div><!-- fragment --><p> Bitmaps are stored as ranges of bits. There are a number of functions for checking and manipulating bitmap ranges.</p>
<p><code>is_empty()</code> returns true if the bitmap contains no elements.</p>
<p><code>bitmin()</code> returns the lowest value element in the bitmap (ie the lowest bit that is set). If the bitmap is empty, it returns null.</p>
<p><code>bitmax()</code> returns the highest element in the bitmap, or null if the bitmap is empty.</p>
<p><code><a class="el" href="pgbitmap_8c.html#a1eed88fa88b6d53eef0942def83bdfd7">bitmap_setmin()</a></code> and <code><a class="el" href="pgbitmap_8c.html#a6611940332cd7d8e76c25ed6e000f2cd">bitmap_setmax()</a></code> can be used to efficiently clear large sections of a bitmap. The result of:</p>
<div class="fragment"><div class="line">select bitmap_setmin(bitmap_of(x), 200)</div><div class="line">      from generate_series(1, 205) x;</div></div><!-- fragment --><p>would be a bitmap with elements 200 to 205.</p>
<h2><a class="el" href="structBitmap.html">Bitmap</a> Comparison Functions and Operators </h2>
<div class="fragment"><div class="line">bitmap_equal(bitmap, bitmap) -&gt; boolean</div><div class="line"></div><div class="line">bitmap_nequal(bitmap, bitmap) -&gt; boolean</div><div class="line"></div><div class="line">bitmap_lt(bitmap, bitmap) -&gt; boolean</div><div class="line"></div><div class="line">bitmap_le(bitmap, bitmap) -&gt; boolean</div><div class="line"></div><div class="line">bitmap_gt(bitmap, bitmap) -&gt; boolean</div><div class="line"></div><div class="line">bitmap_ge(bitmap, bitmap) -&gt; boolean</div><div class="line"></div><div class="line">bitmap_cmp(bitmap, bitmap) -&gt; integer</div><div class="line"></div><div class="line">bitmap = bitmap -&gt; boolean</div><div class="line"></div><div class="line">bitmap &lt;&gt; bitmap -&gt; boolean</div><div class="line"></div><div class="line">bitmap &lt; bitmap -&gt; boolean</div><div class="line"></div><div class="line">bitmap &lt;= bitmap -&gt; boolean</div><div class="line"></div><div class="line">bitmap &gt; bitmap -&gt; boolean</div><div class="line"></div><div class="line">bitmap &gt;= bitmap -&gt; boolean</div></div><!-- fragment --><p> Bitmaps may be compared. This is primarily for the purpose of sorting and indexing. Testing for equality or inequality is probably the only useful comparison from an API perspective.</p>
<h2>Set Operations on Bitmaps </h2>
<div class="fragment"><div class="line">bitmap_union(bitmap, bitmap) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap_intersection(bitmap, bitmap) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap_minus(bitmap, bitmap) -&gt; bitmap</div><div class="line"></div><div class="line">bitmap + bitmap -&gt; bitmap</div><div class="line"></div><div class="line">bitmap * bitmap -&gt; bitmap</div><div class="line"></div><div class="line">bitmap - bitmap -&gt; bitmap</div></div><!-- fragment --><p> These functions and operators act on a pair of bitmaps to yield a result.</p>
<p><code><a class="el" href="pgbitmap_8c.html#af1fb14a8c2c70a0927c140df5375874e">bitmap_union()</a></code>, the <code>+</code> operator, returns a bitmap containing all elements from both arguments. The following queries return identical results:</p>
<div class="fragment"><div class="line">select bitmap_union(to_bitmap({&#39;1 2 3&#39;}),</div><div class="line">                    to_bitmap({&#39;1 3 5&#39;}));</div><div class="line"></div><div class="line">select to_bitmap({&#39;1 2 3 5}&#39;);</div></div><!-- fragment --><p><code>bitmap_intersect()</code>, the <code>*</code> operator, yields the set of common elements from its arguments. The following queries return identical results: </p><div class="fragment"><div class="line">select to_bitmap({&#39;1 2 3}&#39;) * to_bitmap(&#39;{3, 4, 5}&#39;);</div><div class="line"></div><div class="line">select bitmap(3);</div></div><!-- fragment --><p><code><a class="el" href="pgbitmap_8c.html#a5057baf2a406be73117e928e162b537f">bitmap_minus()</a></code>, the <code>-</code> operator, yields a bitmap containing all elements from the first argument that do not appear in the second. These queries return identical results: </p><div class="fragment"><div class="line">select to_bitmap({&#39;1 2 3}&#39;) - to_bitmap(&#39;{3, 4, 5}&#39;);</div><div class="line"></div><div class="line">select to_bitmap(&#39;{1, 2}&#39;);</div></div><!-- fragment --><h2>Extracting all Elements of a <a class="el" href="structBitmap.html">Bitmap</a> </h2>
<div class="fragment"><div class="line">to_array(bitmap) -&gt; array of integer</div><div class="line"></div><div class="line">bits(bitmap) -&gt; set of integer</div></div><!-- fragment --><p>These functions return the elements of a bitmap, either as an array, or as a set. Use the set returning function like this: </p><div class="fragment"><div class="line">select bits as privilege_id</div><div class="line">  from bits(privileges);</div></div><!-- fragment --><p> The <code>to_array()</code> function can also be invoked as a cast, eg: </p><div class="fragment"><div class="line">select privileges::int4[];</div></div><!-- fragment --><h2><a class="el" href="structBitmap.html">Bitmap</a> Aggregates </h2>
<div class="fragment"><div class="line">union_of(bitmap) -&gt; bitmap</div><div class="line"></div><div class="line">intersect_of(bitmap) -&gt; bitmap</div></div><!-- fragment --><p>These functions aggregate a collection of bitmaps using the union or intersect operations. Eg to identify all privileges of all members of a group of offices, we could use something like this: </p><div class="fragment"><div class="line">select union_of(privs) as office_privs, office_name</div><div class="line">  from user_privs</div><div class="line"> where office_name like &#39;%admin%&#39;</div><div class="line"> group by office_name;</div></div><!-- fragment --><h2>Installing pgbitmap using pgxn </h2>
<p>If you're using the pgxn client all you need to do is this: </p><div class="fragment"><div class="line">$ pgxn install pgbitmap</div><div class="line">$ pgxn load -d mydb pgbitmap</div></div><!-- fragment --><h2>Building pgbitmap Manually </h2>
<p>Pgbitmap can be built using the standard Postgres PGXS build mechanism as described here [<a href="https://www.postgresql.org/docs/12/extend-pgxs.html">https://www.postgresql.org/docs/12/extend-pgxs.html</a>].</p>
<p>The build will need to be able to find the pg_config executable that matches your Postgres version. It will attempt to find this using <code>find_pg_config</code> (in the top-level pgbitmap directory). If it cannot find pg_config the build will fail.</p>
<p>You can manually define the location in the <code>PG_CONFIG</code> file: </p><div class="fragment"><div class="line">$ echo &lt;path to pg_config&gt; &gt;PG_CONFIG</div></div><!-- fragment --><p>From the pgbitmap directory (the root directory of the extension), use the following commands: </p><div class="fragment"><div class="line">$ make</div></div><!-- fragment --><p> To build the extension, followed by:</p>
<div class="fragment"><div class="line">$ sudo make install</div></div><!-- fragment --><p> To install it. You may then need to stop and restart your database service to have postgres recognise the extension.</p>
<p>To test the installation use:</p>
<div class="fragment"><div class="line">$ make test</div></div><!-- fragment --><p>To create html documentation (in docs/html/index.html) use:</p>
<div class="fragment"><div class="line">$ make docs</div></div><!-- fragment --><p>You will need to have doxygen and dot installed. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
